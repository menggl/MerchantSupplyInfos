<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>修改资料</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #f2f3f5; font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", Arial, sans-serif; }
        .phone-frame { width: 375px; height: 667px; background-color: #f7f8fa; border-radius: 40px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; display: flex; flex-direction: column; position: relative; border: 12px solid #333; }
        
        .nav-bar { background-color: #1890FF; padding: 44px 15px 10px; display: flex; align-items: center; justify-content: space-between; color: #fff; flex-shrink: 0; position: relative; }
        .nav-left { display: flex; align-items: center; flex: 1; }
        .nav-back { font-size: 24px; cursor: pointer; margin-right: 15px; font-weight: bold; }
        .nav-title { font-size: 18px; font-weight: 600; position: absolute; left: 50%; transform: translateX(-50%); text-align: center; }
        .nav-btn { color: #fff; font-size: 12px; cursor: pointer; border: none; background: none; padding: 4px; font-weight: 400; }
        
        .content { flex: 1; overflow-y: auto; padding: 10px 14px; }
        .section-title { font-size: 11px; color: #858c96; margin: 8px 0 6px 4px; font-weight: 500; letter-spacing: 0.1px; }
        .card { background: #fff; border-radius: 10px; padding: 0 14px; box-shadow: 0 2px 8px rgba(0,0,0,0.02); overflow: hidden; }

        .form-row { display: flex; align-items: center; min-height: 44px; border-bottom: 0.5px solid #f2f2f2; }
        .form-row:last-child { border-bottom: none; }
        .form-label { width: 100px; font-size: 12px; color: #333; font-weight: 500; letter-spacing: -0.1px; }
        .form-input { flex: 1; border: none; font-size: 12px; color: #1a1a1a; outline: none; text-align: right; background: transparent; font-family: inherit; font-weight: 400; }
        .form-input::placeholder { color: #c4c8d0; font-weight: 400; }
        textarea.form-input { padding: 10px 0; text-align: left; line-height: 1.4; resize: none; min-height: 64px; }

        .upload-card { padding: 10px 0; }
        .upload-area { display: flex; align-items: center; justify-content: space-between; background: #f5f7fa; border: 1px dashed #cfd8e3; border-radius: 8px; padding: 12px; }
        .upload-info { font-size: 11px; color: #5c6b7f; }
        .btn-upload { height: 30px; padding: 0 10px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: #fff; border: none; border-radius: 15px; font-size: 12px; font-weight: 600; cursor: pointer; }
        #license-input { display: none; }
        .license-preview { margin-top: 10px; font-size: 11px; color: #5c6b7f; }
        .license-img { width: 100%; border-radius: 8px; margin-top: 8px; display: none; }

        .captcha-row .right, .sms-row .right { flex: 1; display: flex; align-items: center; justify-content: flex-end; gap: 6px; }
        .captcha-code { min-width: 72px; height: 28px; background: linear-gradient(135deg, #eef2f7 0%, #e3e8ef 100%); border-radius: 6px; display: flex; align-items: center; justify-content: center; font-weight: 600; color: #2f3a4b; letter-spacing: 1px; font-size: 13px; cursor: pointer; user-select: none; }
        .captcha-input, .sms-input { width: 84px; text-align: center; border: none; background: #f5f7fa; border-radius: 6px; padding: 5px 6px; font-size: 12px; outline: none; color: #333; font-weight: 500; }
        .btn-mini { height: 28px; padding: 0 8px; border: none; border-radius: 14px; font-size: 12px; font-weight: 600; cursor: pointer; }
        .btn-primary { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: #fff; }
        .btn-secondary { background: #e6eef8; color: #4a67a1; }
        .btn-disabled { background: #ddd; color: #999; cursor: not-allowed; }

        .btn-save { width: 100%; height: 42px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: white; border: none; border-radius: 21px; font-size: 15px; font-weight: 600; cursor: pointer; margin-top: 14px; box-shadow: 0 8px 20px rgba(67, 233, 123, 0.2); letter-spacing: 0.5px; }

        .city-mask { position: absolute; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.35); display: none; }
        .city-sheet { position: absolute; left: 0; bottom: 0; width: 100%; height: 50%; background: #fff; border-top-left-radius: 12px; border-top-right-radius: 12px; box-shadow: 0 -10px 20px rgba(0,0,0,0.08); display: none; padding: 8px 12px; }
        .city-title { font-size: 12px; color: #333; font-weight: 600; text-align: center; margin-bottom: 6px; }
        .city-bar { width: 36px; height: 4px; background: #e5e7eb; border-radius: 2px; margin: 0 auto 8px; }
        .city-list { height: calc(100% - 30px); overflow-y: auto; }
        .city-item { padding: 10px 8px; font-size: 13px; color: #1a1a1a; border-bottom: 1px solid #f2f3f5; cursor: pointer; }
        .city-item:active { background: #f5f7fa; }
        .req-star { color: #ff4d4f; margin-left: 4px; font-weight: 700; }

        .tab-bar { height: 83px; background-color: #fff; border-top: 1px solid #e5e5e5; display: flex; padding-bottom: 20px; }
        .tab-item { flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #999; cursor: pointer; font-size: 10px; }
        .tab-item.active { color: #07c160; }
        .tab-icon { width: 24px; height: 24px; margin-bottom: 4px; background-color: currentColor; mask-size: contain; -webkit-mask-size: contain; mask-repeat: no-repeat; -webkit-mask-repeat: no-repeat; mask-position: center; -webkit-mask-position: center; }
        .icon-home { -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z'/%3E%3C/svg%3E"); mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z'/%3E%3C/svg%3E"); }
        .icon-search { -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z'/%3E%3C/svg%3E"); mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z'/%3E%3C/svg%3E"); }
        .icon-request { -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z'/%3E%3C/svg%3E"); mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z'/%3E%3C/svg%3E"); }
        .icon-me { -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E"); mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z'/%3E%3C/svg%3E"); }
    </style>
</head>
<body>
    <div class="phone-frame">
        <div class="nav-bar">
            <div class="nav-left">
                <div class="nav-back" onclick="history.back()">←</div>
                <div class="nav-title">修改资料</div>
            </div>
            <div style="width: 32px;"></div>
        </div>
        <div class="content">
            <div class="section-title">商家信息</div>
            <div class="card">
                <div class="form-row">
                    <label class="form-label">商家名称<span class="req-star">*</span></label>
                    <input type="text" class="form-input" id="merchant-name" placeholder="请输入商家名称">
                </div>
                <div class="form-row">
                    <label class="form-label">联系方式<span class="req-star">*</span></label>
                    <input type="tel" class="form-input" id="merchant-phone" placeholder="请输入手机号" inputmode="numeric" maxlength="11">
                </div>
                <div class="form-row captcha-row">
                    <label class="form-label">验证码验证<span class="req-star">*</span></label>
                    <div class="right">
                        <div class="captcha-code" id="captcha-code"></div>
                        <input type="text" class="captcha-input" id="captcha-input" placeholder="输入验证码">
                    </div>
                </div>
                <div class="form-row sms-row">
                    <label class="form-label">短信验证码<span class="req-star">*</span></label>
                    <div class="right">
                        <input type="text" class="sms-input" id="sms-input" placeholder="6位数字" maxlength="6" inputmode="numeric">
                        <button class="btn-mini btn-disabled" id="sms-send" disabled>获取验证码</button>
                    </div>
                </div>
                <div class="form-row">
                    <label class="form-label">所在城市<span class="req-star">*</span></label>
                    <input type="text" class="form-input" id="merchant-city" placeholder="请选择城市" readonly>
                </div>
                <div class="form-row">
                    <label class="form-label">联系地址<span class="req-star">*</span></label>
                    <textarea class="form-input" id="merchant-address" placeholder="请输入详细地址"></textarea>
                </div>
            </div>

            <div class="section-title">商家营业执照</div>
            <div class="card upload-card">
                <div class="upload-area">
                    <div class="upload-info" id="license-info">未上传</div>
                    <button class="btn-upload" id="btn-upload">上传营业执照</button>
                    <input type="file" id="license-input" accept="image/*">
                </div>
                <img id="license-img" class="license-img" alt="">
            </div>

            <button class="btn-save" id="btn-save">保存</button>
        </div>

        <div class="city-mask" id="city-mask"></div>
        <div class="city-sheet" id="city-sheet">
            <div class="city-bar"></div>
            <div class="city-title">选择城市</div>
            <div class="city-list" id="city-list"></div>
        </div>

        <div class="tab-bar">
            <div class="tab-item" onclick="location.href='home_mockup.html'">
                <div class="tab-icon icon-home"></div>
                <span>首页</span>
            </div>
            <div class="tab-item" onclick="location.href='search_mockup.html'">
                <div class="tab-icon icon-search"></div>
                <span>查询</span>
            </div>
            <div class="tab-item" onclick="location.href='listings_mockup.html'">
                <div class="tab-icon icon-request"></div>
                <span>求购</span>
            </div>
            <div class="tab-item active" onclick="location.href='me_mockup.html'">
                <div class="tab-icon icon-me"></div>
                <span>我的</span>
            </div>
        </div>
    </div>

    <script>
        const btnUpload = document.getElementById('btn-upload');
        const licenseInput = document.getElementById('license-input');
        const licenseInfo = document.getElementById('license-info');
        const licenseImg = document.getElementById('license-img');
        const btnSave = document.getElementById('btn-save');
        const cityMask = document.getElementById('city-mask');
        const citySheet = document.getElementById('city-sheet');
        const cityList = document.getElementById('city-list');
        const cityInput = document.getElementById('merchant-city');

        btnUpload.onclick = () => licenseInput.click();
        licenseInput.onchange = () => {
            const file = licenseInput.files && licenseInput.files[0];
            if (!file) return;
            licenseInfo.textContent = file.name;
            const url = URL.createObjectURL(file);
            licenseImg.src = url;
            licenseImg.style.display = 'block';
        };

        const cities = ["北京","上海","广州","深圳","杭州","南京","苏州","宁波","无锡","天津","重庆","成都","武汉","西安","郑州","青岛","济南","大连","沈阳","长春","哈尔滨","石家庄","太原","合肥","长沙","福州","厦门","南昌","昆明","贵阳","南宁","海口","兰州","西宁","银川","呼和浩特","乌鲁木齐","拉萨"];
        function openCitySheet() {
            cityMask.style.display = 'block';
            citySheet.style.display = 'block';
        }
        function closeCitySheet() {
            cityMask.style.display = 'none';
            citySheet.style.display = 'none';
        }
        cityInput.onclick = openCitySheet;
        cityMask.onclick = closeCitySheet;
        cityList.innerHTML = '';
        cities.forEach(c => {
            const div = document.createElement('div');
            div.className = 'city-item';
            div.textContent = c;
            div.onclick = () => { cityInput.value = c; closeCitySheet(); };
            cityList.appendChild(div);
        });

        let captcha = '';
        let captchaPassed = false;
        let smsCode = '';
        let smsTimer = null;
        let smsRemain = 0;

        function genCaptcha() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            captcha = Array.from({length: 4}, () => chars[Math.floor(Math.random()*chars.length)]).join('');
            document.getElementById('captcha-code').textContent = captcha;
            captchaPassed = false;
            document.getElementById('sms-send').disabled = true;
            document.getElementById('sms-send').className = 'btn-mini btn-disabled';
        }

        function startSmsCountdown() {
            smsRemain = 60;
            const btn = document.getElementById('sms-send');
            btn.disabled = true;
            btn.className = 'btn-mini btn-disabled';
            btn.textContent = `重新获取(${smsRemain}s)`;
            smsTimer = setInterval(() => {
                smsRemain -= 1;
                if (smsRemain <= 0) {
                    clearInterval(smsTimer);
                    smsTimer = null;
                    btn.disabled = false;
                    btn.className = 'btn-mini btn-primary';
                    btn.textContent = '获取验证码';
                } else {
                    btn.textContent = `重新获取(${smsRemain}s)`;
                }
            }, 1000);
        }

        document.getElementById('captcha-code').onclick = genCaptcha;
        function validateCaptchaAuto() {
            const input = document.getElementById('captcha-input').value.trim();
            const phone = document.getElementById('merchant-phone').value.trim();
            const btn = document.getElementById('sms-send');
            const phoneValid = /^\d{11}$/.test(phone);
            const captchaLenValid = input.length === 4;
            if (!phoneValid || !captchaLenValid) { 
                captchaPassed = false;
                btn.disabled = true; 
                btn.className = 'btn-mini btn-disabled';
                return; 
            }
            captchaPassed = true;
            btn.disabled = false;
            btn.className = 'btn-mini btn-primary';
        }
        document.getElementById('captcha-input').addEventListener('input', validateCaptchaAuto);
        document.getElementById('merchant-phone').addEventListener('input', validateCaptchaAuto);

        document.getElementById('sms-send').onclick = () => {
            if (!captchaPassed) { alert('请先完成验证码验证'); return; }
            const phone = document.getElementById('merchant-phone').value.trim();
            if (!/^\d{11}$/.test(phone)) { alert('请输入正确的11位手机号'); return; }
            smsCode = String(Math.floor(100000 + Math.random()*900000));
            alert(`短信验证码: ${smsCode}`);
            startSmsCountdown();
        };

        genCaptcha();

        btnSave.onclick = () => {
            const name = document.getElementById('merchant-name').value.trim();
            const phone = document.getElementById('merchant-phone').value.trim();
            const city = document.getElementById('merchant-city').value.trim();
            const address = document.getElementById('merchant-address').value.trim();
            const smsInput = document.getElementById('sms-input').value.trim();
            if (!name || !phone || !city || !address) {
                alert('请完善必填信息');
                return;
            }
            if (!/^\d{11}$/.test(phone)) {
                alert('请输入正确的11位手机号');
                return;
            }
            if (!captchaPassed) {
                alert('请先完成验证码验证');
                return;
            }
            if (!/^\d{6}$/.test(smsInput) || smsInput !== smsCode) {
                alert('短信验证码错误或未获取');
                return;
            }
            alert('保存成功');
            history.back();
        };
    </script>
</body>
</html>
